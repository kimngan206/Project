<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Kho - Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="image/icon.png">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
            color: #1f2937;
        }

        .modal {
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-content {
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

        .modal-visible .modal-content {
            transform: translateY(0);
        }

        h1 {
            color: #dc2626;
        }

        .p-4 {
            height: auto;
        }
    </style>
</head>

<body class="bg-gray-100 flex flex-col font-sans">
    <!-- Header ƒë√£ ƒë∆∞·ª£c x√≥a theo y√™u c·∫ßu -->

    <div class="flex flex-1">
        <!-- Sidebar -->
        <aside class="w-64 bg-white h-screen shadow-2xl p-4" style="height: auto;">
            <h2 class="text-3xl font-bold text-red-600 mb-8 text-center py-4">AnhEm Motor</h2>
            <nav>
                <ul class="space-y-4">
                    <li><a href="index.html"
                            class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition-colors text-gray-800">
                            <i class="fa-solid fa-house w-6 text-xl text-center text-red-600"></i><span>Trang
                                ch·ªß</span></a>
                    </li>
                    <li><a href="report.html"
                            class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition-colors text-gray-800">
                            <i class="fa-solid fa-chart-line w-6 text-xl text-center text-red-600"></i><span>B√°o
                                c√°o</span></a>
                    </li>
                    <li><a href="revenue.html"
                            class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition-colors text-gray-800">
                            <i class="fa-solid fa-chart-pie w-6 text-xl text-center text-red-600"></i><span>Ph√¢n T√≠ch
                                Doanh Thu</span></a>
                    </li>
                    <li><a href="inventory.html"
                            class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition-colors text-gray-800">
                            <i class="fa-solid fa-box w-6 text-xl text-center text-red-600"></i><span>B√°o C√°o S·∫£n
                                Ph·∫©m</span></a>
                    </li>
                    <li><a href="quanlykh.html"
                            class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition-colors text-gray-800">
                            <i class="fa-solid fa-users w-6 text-xl text-center text-red-700"></i><span>Qu·∫£n l√Ω Kh√°ch
                                H√†ng</span></a>
                    </li>
                    <li><a href="order1.html"
                            class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition-colors text-gray-800">
                            <i class="fa-solid fa-cart-shopping w-6 text-xl text-center text-red-600"></i><span>Qu·∫£n l√Ω
                                ƒê∆°n H√†ng</span></a>
                    </li>
                    <li><a href="quanlysp.html"
                            class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition-colors text-gray-800">
                            <i class="fa-solid fa-motorcycle w-6 text-xl text-center text-red-600"></i><span>Qu·∫£n l√Ω S·∫£n
                                Ph·∫©m</span></a>
                    </li>

                    <li>
                        <!-- Li√™n k·∫øt ch√≠nh, khi nh·∫•p v√†o s·∫Ω ƒëi·ªÅu h∆∞·ªõng ƒë·∫øn trang kho -->
                        <a href="warehouse.html" id="nav-order-management"
                            class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-200 transition-colors duration-200 text-gray-800">
                            <div class="flex items-center space-x-3">
                                <i class="fa-solid fa-warehouse w-6 text-xl text-center text-red-600"></i>
                                <span>Qu·∫£n l√Ω kho</span>
                            </div>
                            <!-- N√∫t m≈©i t√™n ƒë·ªÉ m·ªü menu con -->
                            <svg class="h-4 w-4 transform transition-transform duration-200 text-gray-500 cursor-pointer"
                                id="order-dropdown-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"
                                onclick="event.preventDefault(); event.stopPropagation(); toggleDropdown('order-dropdown')">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5l7 7-7 7" />
                            </svg>
                        </a>
                        <!-- Menu con -->
                        <ul id="order-dropdown" class="ml-8 mt-2 space-y-2 hidden">
                            <li>
                                <a href="NCC.html" id="nav-motorcycle"
                                    class="nav-link flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                                    <span>Nh√† cung c·∫•p</span>
                                </a>
                            </li>
                            <li>
                                <a href="import.html" id="nav-parts"
                                    class="nav-link flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                                    <span>Nh·∫≠p h√†ng</span>
                                </a>
                            </li>
                            <li>
                                <a href="cost.html" id="nav-accessories"
                                    class="nav-link flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                                    <span>Thi·∫øt l·∫≠p gi√°</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="mt-auto pt-4 border-t border-gray-200">
                        <a href="index.html"
                            class="flex items-center space-x-3 p-3 rounded-lg hover:bg-red-100 transition-colors duration-200 text-gray-800 hover:text-red-700 font-semibold">
                            <i class="fa-solid fa-arrow-left w-6 text-xl text-center text-red-600"></i>
                            <span>Quay v·ªÅ Trang ch·ªß</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main -->
        <main class="flex-1 p-8 bg-white">
            <h1 class="text-3xl font-bold mb-6 text-red-600">üì¶ Qu·∫£n l√Ω kho h√†ng</h1>

            <!-- Th·ªëng k√™ nhanh -->
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
                <div class="bg-white p-4 rounded shadow text-center">
                    <h3 class="text-gray-500 text-sm">T·ªïng m·∫∑t h√†ng</h3>
                    <p id="totalItems" class="text-2xl font-bold text-red-600"></p>
                </div>
                <div class="bg-white p-4 rounded shadow text-center">
                    <h3 class="text-gray-500 text-sm">S·∫Øp h·∫øt h√†ng</h3>
                    <p id="lowStock" class="text-2xl font-bold text-yellow-500"></p>
                </div>
                <div class="bg-white p-4 rounded shadow text-center">
                    <h3 class="text-gray-500 text-sm">H·∫øt h√†ng</h3>
                    <p id="outStock" class="text-2xl font-bold text-red-700"></p>
                </div>
            </div>

            <!-- B·ªô l·ªçc -->
            <div class="flex justify-between items-center mb-6 flex-wrap gap-3">
                <div class="flex flex-wrap items-center gap-2">
                    <input id="search" type="text" placeholder="üîç T√¨m ki·∫øm t√™n, danh m·ª•c..."
                        class="border p-2 rounded w-full sm:w-auto">
                    <select id="filterDanhMuc" class="border p-2 rounded">
                        <option value="">-- Danh m·ª•c --</option>
                        <option value="Xe m√°y">Xe m√°y</option>
                        <option value="Ph·ª• t√πng">Ph·ª• t√πng</option>
                        <option value="Trang ph·ª•c">Trang ph·ª•c</option>
                        <option value="H√≥a ch·∫•t">H√≥a ch·∫•t</option>
                    </select>
                    <select id="filterTrangThai" class="border p-2 rounded">
                        <option value="">-- Tr·∫°ng th√°i --</option>
                        <option value="C√≤n h√†ng">C√≤n h√†ng</option>
                        <option value="S·∫Øp h·∫øt h√†ng">S·∫Øp h·∫øt h√†ng</option>
                        <option value="H·∫øt h√†ng">H·∫øt h√†ng</option>
                    </select>
                    <!-- B·ªô l·ªçc Nh√† cung c·∫•p ƒë√£ ƒë∆∞·ª£c x√≥a -->
                    <button onclick="applyFilters()"
                        class="bg-gray-300 rounded px-4 py-2 hover:bg-gray-400">L·ªçc</button>
                    <button onclick="resetFilters()" class="bg-gray-200 rounded px-4 py-2 hover:bg-gray-300">üîÑ L√†m
                        m·ªõi</button>
                </div>
                <div class="flex gap-2">
                    <button onclick="exportToCSV()"
                        class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                        ‚¨áÔ∏è Xu·∫•t CSV
                    </button>
                </div>
            </div>

            <!-- B·∫£ng d·ªØ li·ªáu -->
            <div class="overflow-x-auto shadow-md rounded-lg">
                <table class="w-full border-collapse border text-sm text-left">
                    <thead class="bg-red-100 text-gray-700 uppercase">
                        <tr>
                            <th class="border p-3">M√£ ID</th>
                            <th class="border p-3">T√™n m·∫∑t h√†ng</th>
                            <th class="border p-3">Ng√†y nh·∫≠p g·∫ßn nh·∫•t</th>
                            <th class="border p-3">Danh m·ª•c</th>
                            <th class="border p-3">T·ªìn kho</th>
                            <th class="border p-3">ƒê√£ ƒë·∫∑t</th>
                            <th class="border p-3">Hi·ªán c√≥</th>
                            <th class="border p-3">Tr·∫°ng th√°i</th>
                            <th class="border p-3">Gi√° b√°n</th>
                            <th class="border p-3">Nh√† cung c·∫•p</th>
                            <th class="border p-3 text-center">H√†nh ƒë·ªông</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>

            <!-- Ph√¢n trang -->
            <div id="pagination" class="flex justify-end items-center mt-4"></div>
        </main>
    </div>

    <script>
        // --- TH√äM M·ªöI ---
        // H√†m ƒë·ªÉ b·∫≠t/t·∫Øt menu con v√† xoay m≈©i t√™n
        function toggleDropdown(dropdownId) {
            const dropdown = document.getElementById(dropdownId);
            const icon = document.getElementById('order-dropdown-icon');
            dropdown.classList.toggle('hidden');
            icon.classList.toggle('rotate-90');
        }
        // --- K·∫æT TH√öC TH√äM M·ªöI ---

        let currentPage = 1;
        const rowsPerPage = 10;

        // D·ªØ li·ªáu m·∫´u ƒë√£ ƒë∆∞·ª£c b·ªï sung
        const duLieuMau = [
            { id: "K001", ngayNhap: "2025-10-01", matHang: "Honda Wave Alpha 110", danhMuc: "Xe m√°y", tonDau: 10, ton: 3, giaBan: 18500000, nhaCungCap: "Honda Vi·ªát Nam" },
            { id: "K002", ngayNhap: "2025-09-25", matHang: "Yamaha Exciter 155 VVA", danhMuc: "Xe m√°y", tonDau: 7, ton: 5, giaBan: 50000000, nhaCungCap: "Yamaha Accessories" },
            { id: "K003", ngayNhap: "2025-10-05", matHang: "M≈© b·∫£o hi·ªÉm 3/4 Protec", danhMuc: "Trang ph·ª•c", tonDau: 45, ton: 12, giaBan: 750000, nhaCungCap: "Protec" },
            { id: "K004", ngayNhap: "2025-09-18", matHang: "Nh·ªõt Castrol Power 1 Scooter", danhMuc: "H√≥a ch·∫•t", tonDau: 80, ton: 5, giaBan: 165000, nhaCungCap: "Castrol" },
            { id: "K005", ngayNhap: "2025-10-10", matHang: "L·ªëp Michelin Pilot Street 80/90-14", danhMuc: "Ph·ª• t√πng", tonDau: 35, ton: 28, giaBan: 620000, nhaCungCap: "Michelin" },
            { id: "K006", ngayNhap: "2025-09-28", matHang: "D·∫ßu Motul 300V Factory Line 1L", danhMuc: "H√≥a ch·∫•t", tonDau: 20, ton: 18, giaBan: 450000, nhaCungCap: "Motul Vi·ªát Nam" },
            { id: "K007", ngayNhap: "2025-10-02", matHang: "·∫Æc quy GS GTZ6V", danhMuc: "Ph·ª• t√πng", tonDau: 15, ton: 0, giaBan: 450000, nhaCungCap: "GS Battery Vi·ªát Nam" },
            { id: "K008", ngayNhap: "2025-09-15", matHang: "√Åo gi√°p Scoyco JK42", danhMuc: "Trang ph·ª•c", tonDau: 10, ton: 9, giaBan: 2800000, nhaCungCap: "Scoyco" },
            { id: "K009", ngayNhap: "2025-10-12", matHang: "Bugi NGK C7HSA", danhMuc: "Ph·ª• t√πng", tonDau: 120, ton: 110, giaBan: 65000, nhaCungCap: "NGK Spark Plugs" },
            { id: "K010", ngayNhap: "2025-10-14", matHang: "N∆∞·ªõc l√†m m√°t Liqui Moly 1L", danhMuc: "H√≥a ch·∫•t", tonDau: 40, ton: 38, giaBan: 190000, nhaCungCap: "Liqui Moly" },
            { id: "K011", ngayNhap: "2025-09-01", matHang: "Nh√¥ng s√™n dƒ©a DID 428D", danhMuc: "Ph·ª• t√πng", tonDau: 60, ton: 4, giaBan: 850000, nhaCungCap: "DID" },
            { id: "K012", ngayNhap: "2025-10-08", matHang: "K√≠nh ch·∫Øn gi√≥ Zhipat Vision", danhMuc: "Ph·ª• t√πng", tonDau: 25, ton: 20, giaBan: 350000, nhaCungCap: "Honda Vi·ªát Nam" },
            { id: "K013", ngayNhap: "2025-10-06", matHang: "GƒÉng tay da ch·ªëng n∆∞·ªõc", danhMuc: "Trang ph·ª•c", tonDau: 15, ton: 14, giaBan: 550000, nhaCungCap: "Yamaha Accessories" },
            { id: "K014", ngayNhap: "2025-09-22", matHang: "Chai x·ªãt s√™n Motul C1", danhMuc: "H√≥a ch·∫•t", tonDau: 70, ton: 65, giaBan: 220000, nhaCungCap: "Motul Vi·ªát Nam" },
            { id: "K015", ngayNhap: "2025-09-10", matHang: "Tay th·∫Øng Racing Boy", danhMuc: "Ph·ª• t√πng", tonDau: 30, ton: 2, giaBan: 700000, nhaCungCap: "Yamaha Accessories" },
            { id: "K016", ngayNhap: "2025-10-03", matHang: "Honda Winner X 150", danhMuc: "Xe m√°y", tonDau: 5, ton: 0, giaBan: 46000000, nhaCungCap: "Honda Vi·ªát Nam" },
            { id: "K017", ngayNhap: "2025-09-05", matHang: "L·ªëp Michelin City Grip 100/90-10", danhMuc: "Ph·ª• t√πng", tonDau: 40, ton: 38, giaBan: 780000, nhaCungCap: "Michelin" },
            { id: "K018", ngayNhap: "2025-10-15", matHang: "D·∫ßu phanh Liqui Moly DOT 4", danhMuc: "H√≥a ch·∫•t", tonDau: 50, ton: 45, giaBan: 120000, nhaCungCap: "Liqui Moly" },
            { id: "K019", ngayNhap: "2025-09-29", matHang: "B·∫°c ƒë·∫°n SKF Explorer", danhMuc: "Ph·ª• t√πng", tonDau: 80, ton: 75, giaBan: 150000, nhaCungCap: "GS Battery Vi·ªát Nam" },
            { id: "K020", ngayNhap: "2025-10-11", matHang: "√Åo m∆∞a b·ªô cao c·∫•p", danhMuc: "Trang ph·ª•c", tonDau: 20, ton: 19, giaBan: 450000, nhaCungCap: "Protec" },
            { id: "K021", ngayNhap: "2025-10-13", matHang: "Honda Air Blade 125", danhMuc: "Xe m√°y", tonDau: 8, ton: 7, giaBan: 43000000, nhaCungCap: "Honda Vi·ªát Nam" },
            { id: "K022", ngayNhap: "2025-09-07", matHang: "Buggy NGK CPR8EA-9", danhMuc: "Ph·ª• t√πng", tonDau: 90, ton: 88, giaBan: 70000, nhaCungCap: "NGK Spark Plugs" },
            { id: "K023", ngayNhap: "2025-10-04", matHang: "V·ªá sinh bu·ªìng ƒë·ªët Liqui Moly", danhMuc: "H√≥a ch·∫•t", tonDau: 30, ton: 1, giaBan: 320000, nhaCungCap: "Liqui Moly" },
            { id: "K024", ngayNhap: "2025-09-20", matHang: "D√¢y curoa Bando", danhMuc: "Ph·ª• t√πng", tonDau: 20, ton: 18, giaBan: 580000, nhaCungCap: "DID" },
            { id: "K025", ngayNhap: "2025-10-16", matHang: "D·∫ßu h·ªôp s·ªë Motul Gear 300", danhMuc: "H√≥a ch·∫•t", tonDau: 50, ton: 48, giaBan: 280000, nhaCungCap: "Motul Vi·ªát Nam" },
            { id: "K026", ngayNhap: "2025-10-17", matHang: "B∆°m l·ªëp mini c·∫ßm tay", danhMuc: "Ph·ª• t√πng", tonDau: 18, ton: 15, giaBan: 400000, nhaCungCap: "GS Battery Vi·ªát Nam" },
        ];

        // Kh·ªüi t·∫°o d·ªØ li·ªáu v√†o localStorage n·∫øu ch∆∞a c√≥
        if (!localStorage.getItem("kho") || JSON.parse(localStorage.getItem("kho")).length < duLieuMau.length) {
            localStorage.setItem("kho", JSON.stringify(duLieuMau));
        }

        let kho = JSON.parse(localStorage.getItem("kho")) || [];

        function deleteItem(id) {
            if (window.confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y kh√¥ng?")) {
                kho = kho.filter(item => item.id !== id);
                localStorage.setItem("kho", JSON.stringify(kho));
                renderTable();
            }
        }

        function applyFilters() {
            currentPage = 1;
            renderTable();
        }

        function resetFilters() {
            document.getElementById("search").value = "";
            document.getElementById("filterDanhMuc").value = "";
            document.getElementById("filterTrangThai").value = "";
            currentPage = 1;
            renderTable();
        }

        function renderPagination(totalItems) {
            const paginationContainer = document.getElementById("pagination");
            paginationContainer.innerHTML = "";
            const pageCount = Math.ceil(totalItems / rowsPerPage);
            if (pageCount <= 1) return;

            // N√∫t "Tr∆∞·ªõc"
            const prevButton = document.createElement('button');
            prevButton.innerHTML = `<i class="fa-solid fa-chevron-left"></i> Tr∆∞·ªõc`;
            prevButton.disabled = currentPage === 1;
            prevButton.className = 'px-3 py-1 mx-1 rounded-lg border bg-white hover:bg-gray-100 disabled:opacity-50 text-sm shadow';
            prevButton.onclick = () => { if (currentPage > 1) { currentPage--; renderTable(); } };
            paginationContainer.appendChild(prevButton);

            // C√°c n√∫t s·ªë trang
            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(pageCount, currentPage + 2);

            if (currentPage <= 3) endPage = Math.min(pageCount, 5);
            if (currentPage > pageCount - 2) startPage = Math.max(1, pageCount - 4);

            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.innerText = i;
                pageButton.className = `px-3 py-1 mx-1 rounded-lg border text-sm shadow ${currentPage === i ? 'bg-red-600 text-white border-red-600' : 'bg-white hover:bg-red-500 hover:text-white border-gray-300'}`;
                pageButton.onclick = () => { currentPage = i; renderTable(); };
                paginationContainer.appendChild(pageButton);
            }

            // N√∫t "Sau"
            const nextButton = document.createElement('button');
            nextButton.innerHTML = `Sau <i class="fa-solid fa-chevron-right"></i>`;
            nextButton.disabled = currentPage === pageCount;
            nextButton.className = 'px-3 py-1 mx-1 rounded-lg border bg-white hover:bg-gray-100 disabled:opacity-50 text-sm shadow';
            nextButton.onclick = () => { if (currentPage < pageCount) { currentPage++; renderTable(); } };
            paginationContainer.appendChild(nextButton);
        }

        function renderTable() {
            const search = document.getElementById("search").value.toLowerCase().trim();
            const filterDanhMuc = document.getElementById("filterDanhMuc").value;
            const filterTrangThai = document.getElementById("filterTrangThai").value;

            // L·ªçc d·ªØ li·ªáu
            let filtered = kho.filter(k => {
                const trangThaiHienTai = k.ton === 0 ? "H·∫øt h√†ng" : (k.ton <= 5 ? "S·∫Øp h·∫øt h√†ng" : "C√≤n h√†ng");

                const matchesSearch = (k.matHang.toLowerCase().includes(search) || k.danhMuc.toLowerCase().includes(search) || k.id.toLowerCase().includes(search));
                const matchesDanhMuc = (!filterDanhMuc || k.danhMuc === filterDanhMuc);
                const matchesTrangThai = (!filterTrangThai || trangThaiHienTai === filterTrangThai);

                return matchesSearch && matchesDanhMuc && matchesTrangThai;
            });

            // Ph√¢n trang
            const start = (currentPage - 1) * rowsPerPage;
            const paginated = filtered.slice(start, start + rowsPerPage);

            const tableBody = document.getElementById("tableBody");
            tableBody.innerHTML = "";

            paginated.forEach(k => {
                const row = document.createElement("tr");
                row.className = 'hover:bg-gray-50 transition-colors';
                const trangThai = k.ton === 0 ? "H·∫øt h√†ng" : (k.ton <= 5 ? "S·∫Øp h·∫øt h√†ng" : "C√≤n h√†ng");
                const mauTrangThai = k.ton === 0 ? "text-red-600" : (k.ton <= 5 ? "text-yellow-600" : "text-green-600");
                const giaBanFormat = k.giaBan.toLocaleString('vi-VN');

                row.innerHTML = `
                    <td class="border p-3 font-medium text-gray-900">${k.id}</td>
                    <td class="border p-3">${k.matHang}</td>
                    <td class="border p-3">${k.ngayNhap}</td>
                    <td class="border p-3">${k.danhMuc}</td>
                    <td class="border p-3">${k.tonDau}</td>
                    <td class="border p-3">${k.tonDau - k.ton}</td>
                    <td class="border p-3 font-bold">${k.ton}</td>
                    <td class="border p-3 font-semibold ${mauTrangThai}">${trangThai}</td>
                    <td class="border p-3 font-semibold text-gray-800">${giaBanFormat}‚Ç´</td>
                    <td class="border p-3">${k.nhaCungCap}</td>
                    <td class="border p-3 text-center">
                        <button onclick="deleteItem('${k.id}')" title="Xo√° s·∫£n ph·∫©m" class="text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </td>`;
                tableBody.appendChild(row);
            });

            // C·∫≠p nh·∫≠t th·ªëng k√™
            document.getElementById("totalItems").innerText = kho.length;
            document.getElementById("lowStock").innerText = kho.filter(k => k.ton > 0 && k.ton <= 5).length;
            document.getElementById("outStock").innerText = kho.filter(k => k.ton === 0).length;

            renderPagination(filtered.length);
        }

        // Ch·ª©c nƒÉng xu·∫•t CSV c√≥ th√™m BOM ƒë·ªÉ h·ªó tr·ª£ Excel m·ªü ƒë√∫ng ƒë·ªãnh d·∫°ng ti·∫øng Vi·ªát
        function exportToCSV() {
            const BOM = "\uFEFF"; // Byte Order Mark for UTF-8 in Excel
            const csvRows = [];
            const headers = ["M√£ ID", "T√™n m·∫∑t h√†ng", "Ng√†y nh·∫≠p g·∫ßn nh·∫•t", "Danh m·ª•c", "T·ªìn kho", "ƒê√£ ƒë·∫∑t", "Hi·ªán c√≥", "Tr·∫°ng th√°i", "Gi√° b√°n", "Nh√† cung c·∫•p"];
            csvRows.push(headers.map(h => `"${h}"`).join(',')); // ƒê·∫£m b·∫£o header c√≥ d·∫•u ngo·∫∑c k√©p

            kho.forEach(k => {
                const trangThai = k.ton === 0 ? "H·∫øt h√†ng" : (k.ton <= 5 ? "S·∫Øp h·∫øt h√†ng" : "C√≤n h√†ng");
                const giaBanClean = k.giaBan.toString(); // Ch·ªâ xu·∫•t s·ªë, kh√¥ng c√≥ k√Ω t·ª± ti·ªÅn t·ªá

                const row = [
                    k.id,
                    k.matHang,
                    k.ngayNhap,
                    k.danhMuc,
                    k.tonDau,
                    k.tonDau - k.ton,
                    k.ton,
                    trangThai,
                    giaBanClean,
                    k.nhaCungCap
                ];
                // Th√™m d·∫•u ngo·∫∑c k√©p cho c√°c tr∆∞·ªùng c√≥ th·ªÉ ch·ª©a d·∫•u ph·∫©y
                csvRows.push(row.map(item => `"${item}"`).join(','));
            });

            const csvContent = BOM + csvRows.join('\n');

            // T·∫°o Blob v·ªõi charset utf-8
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'bao_cao_kho_hang.csv'; // Excel s·∫Ω m·ªü file .csv n√†y
            a.click();
        }

        document.getElementById("search").addEventListener("keypress", e => {
            if (e.key === "Enter") applyFilters();
        });

        // T·∫£i b·∫£ng khi trang ƒë∆∞·ª£c t·∫£i
        document.addEventListener('DOMContentLoaded', renderTable);
    </script>
</body>

</html>