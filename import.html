<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Nhập Hàng</title>
    <!-- Tải Tailwind CSS CDN để tạo giao diện hiện đại và responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tải thư viện Flatpickr cho việc chọn ngày tháng -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <!-- Thư viện để xuất file Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        /* Thiết lập font Inter làm font chính cho giao diện */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            /* Nền xám nhạt */
        }

        /* Tùy chỉnh thanh cuộn cho đẹp hơn */
        .custom-scroll::-webkit-scrollbar {
            width: 8px;
        }

        .custom-scroll::-webkit-scrollbar-thumb {
            background-color: #d1d5db;
            /* Màu xám nhẹ */
            border-radius: 10px;
        }

        /* Class để đánh dấu phiếu nhập đang mở */
        .item-open .summary-row {
            background-color: #fef2f2;
            /* Red-50 */
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
            border: 1px solid #fca5a5;
            /* Red-300 */
        }

        /* Định nghĩa bố cục Grid cho cả header và dòng dữ liệu */
        .summary-row-grid {
            /* 1 cột auto (checkbox), 5 cột chính chia đều (1fr), 1 cột auto (trạng thái) */
            grid-template-columns: auto minmax(0, 1fr) minmax(0, 1fr) minmax(0, 1fr) minmax(0, 1fr) minmax(0, 1fr) auto;
        }

        /* Thêm style cho popup bộ lọc thời gian */
        .time-filter-popup {
            display: none;
            /* Ẩn mặc định */
            z-index: 50;
            /* Tăng z-index để nổi lên trên */
        }

        /* CSS để tối ưu hóa cho việc in ấn */
        @media print {

            /* Ẩn các phần tử không cần thiết */
            body>div>header,
            body>div>div>div:first-child,
            .summary-row,
            .print-hidden,
            body>div>div>div:last-child>footer {
                display: none !important;
            }

            /* Đảm bảo chỉ chi tiết của phiếu đang in được hiển thị */
            .inventory-item:not(.printing-item) {
                display: none !important;
            }

            .inventory-item {
                box-shadow: none !important;
                border: none !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            .printing-item .detail-panel {
                display: block !important;
                padding: 0 !important;
                border: none !important;
                box-shadow: none !important;
            }

            .main-content-container {
                padding: 0 !important;
            }

            body {
                background-color: white;
            }
        }
    </style>
</head>

<body>

    <!-- Khung chính toàn màn hình -->
    <div class="flex flex-col h-screen overflow-hidden">

        <!-- 1. Thanh Header (Top Bar) -->
        <header
            class="flex items-center justify-between bg-white shadow-md py-2 px-4 border-b border-gray-200 print-hidden">
            <h1 class="text-lg font-semibold text-gray-800 hidden sm:block">Nhập hàng</h1>

            <!-- Ô tìm kiếm và lọc -->
            <div class="flex items-center space-x-2 flex-grow mx-4 max-w-md">
                <div class="relative w-full">
                    <input type="text" placeholder="Tìm kiếm phiếu nhập..."
                        class="w-full p-1.5 pl-8 border border-gray-300 rounded-md text-xs focus:ring-red-500 focus:border-red-500">
                    <svg class="w-3.5 h-3.5 text-gray-400 absolute left-2 top-1/2 transform -translate-y-1/2"
                        fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
                <button class="p-1.5 border border-gray-300 rounded-md bg-gray-50 hover:bg-gray-100 text-gray-600">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8h12a2 2 0 002-2v-3a2 2 0 00-2-2H6a2 2 0 00-2 2v3a2 2 0 002 2z">
                        </path>
                    </svg>
                </button>
            </div>

            <!-- Các nút hành động -->
            <div class="flex items-center space-x-2">
                <a href="them-moi-phieu-nhap.html"
                    class="flex items-center space-x-1 bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-xs font-medium transition duration-150">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                    <span>Nhập hàng</span>
                </a>
                <div class="relative">
                    <button
                        class="flex items-center space-x-1 bg-gray-100 text-gray-700 py-1.5 px-3 rounded-md hover:bg-gray-200 text-xs font-medium transition duration-150 border border-gray-300">
                        <span>Xuất file</span>
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7">
                            </path>
                        </svg>
                    </button>
                </div>
                <!-- Icons bên phải -->
                <button class="text-gray-500 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100 hidden sm:block">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8.228 9.247a3 3 0 100 5.506 3 3 0 100-5.506z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 11a3 3 0 100 6 3 3 0 000-6z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 9a2 2 0 012 2v2a2 2 0 01-2 2h-1a2 2 0 01-2-2v-2a2 2 0 012-2h1z"></path>
                    </svg>
                </button>
                <button class="text-gray-500 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100 hidden sm:block">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M5.121 17.804A13.935 13.935 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0z">
                        </path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 14c-5.143 0-9.574 3.007-11.233 7.558.175.247.368.488.577.726a13.935 13.935 0 0010.656 2.716c3.279.172 6.556-.27 9.544-1.314.28-.103.55-.21.807-.323-1.659-4.551-6.09-7.558-11.233-7.558z">
                        </path>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Khung nội dung chính (Sidebar + Main) -->
        <div class="flex flex-1 overflow-hidden">

            <!-- 2. Sidebar (Cột Trái) - Thu nhỏ padding và text -->
            <div
                class="w-60 bg-white border-r border-gray-200 p-3 flex-shrink-0 custom-scroll overflow-y-auto print-hidden">

                <!-- Nhóm trạng thái -->
                <div class="mb-4">
                    <h2 class="text-gray-500 font-semibold mb-2 text-xs uppercase">Trạng thái</h2>
                    <ul class="space-y-1 text-xs text-gray-700">
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="status-draft"
                                class="status-filter w-3 h-3 rounded text-red-600 focus:ring-red-500" checked>
                            <label for="status-draft">Phiếu tạm</label>
                        </li>
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="status-received"
                                class="status-filter w-3 h-3 rounded text-red-600 focus:ring-red-500" checked>
                            <label for="status-received" class="font-medium">Đã nhập hàng</label>
                        </li>
                        <li class="flex items-center space-x-2">
                            <input type="checkbox" id="status-cancelled"
                                class="status-filter w-3 h-3 rounded text-red-600 focus:ring-red-500" checked>
                            <label for="status-cancelled">Đã hủy</label>
                        </li>
                    </ul>
                </div>

                <!-- Nhóm thời gian (ĐÃ CẬP NHẬT) -->
                <div class="mb-4">
                    <h2 class="text-gray-500 font-semibold mb-2 text-xs uppercase">Thời gian</h2>
                    <div class="relative text-xs text-gray-700">
                        <!-- Nút hiển thị bộ lọc hiện tại và mở popup -->
                        <button id="time-filter-button"
                            class="w-full flex items-center justify-between cursor-pointer bg-red-50 text-red-700 py-1.5 px-2 rounded-md border border-red-200">
                            <div class="flex items-center space-x-2">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M8 7V3m8 4V3m-9 8h.01M3 21h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v12a2 2 0 002 2z">
                                    </path>
                                </svg>
                                <span id="selected-time-filter" class="font-medium">Tháng này</span>
                            </div>
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <!-- Popup bộ lọc chi tiết (ĐÃ ĐIỀU CHỈNH) -->
                        <div id="time-filter-popup"
                            class="time-filter-popup fixed w-[520px] bg-white border border-gray-200 rounded-md shadow-lg p-3">
                            <div class="grid grid-cols-5 gap-2 text-center">
                                <!-- Headers -->
                                <div class="font-semibold">Theo ngày</div>
                                <div class="font-semibold">Theo tuần</div>
                                <div class="font-semibold">Theo tháng</div>
                                <div class="font-semibold">Theo quý</div>
                                <div class="font-semibold">Theo năm</div>
                                <!-- Options -->
                                <button class="time-option p-1 rounded hover:bg-gray-100">Hôm nay</button>
                                <button class="time-option p-1 rounded hover:bg-gray-100">Tuần này</button>
                                <button class="time-option p-1 rounded bg-red-600 text-white">Tháng này</button>
                                <button class="time-option p-1 rounded hover:bg-gray-100">Quý này</button>
                                <button class="time-option p-1 rounded hover:bg-gray-100">Năm nay</button>

                                <button class="time-option p-1 rounded hover:bg-gray-100">Hôm qua</button>
                                <button class="time-option p-1 rounded hover:bg-gray-100">Tuần trước</button>
                                <button class="time-option p-1 rounded hover:bg-gray-100">Tháng trước</button>
                                <button class="time-option p-1 rounded hover:bg-gray-100">Quý trước</button>
                                <button class="time-option p-1 rounded hover:bg-gray-100">Năm trước</button>

                                <div></div> <!-- empty cell -->
                                <button class="time-option p-1 rounded hover:bg-gray-100">7 ngày qua</button>
                                <button class="time-option p-1 rounded hover:bg-gray-100">30 ngày qua</button>
                                <div></div> <!-- empty cell -->
                                <div></div> <!-- empty cell -->
                            </div>
                            <div class="border-t mt-3 pt-2">
                                <label class="flex items-center space-x-2 cursor-pointer p-1 rounded hover:bg-gray-100">
                                    <input type="radio" name="time-choice" class="form-radio h-3 w-3 text-red-600">
                                    <span>Tùy chỉnh</span>
                                </label>
                                <div class="mt-2">
                                    <input id="custom-date-range" type="text" placeholder="Chọn khoảng thời gian"
                                        class="w-full p-1 border border-gray-300 rounded text-xs">
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

            <!-- 3. Khu vực Nội dung chính -->
            <div class="flex-1 flex flex-col overflow-hidden">

                <!-- Thanh Header cho danh sách phiếu nhập - Giảm padding và text -->
                <div class="flex-shrink-0 bg-white border-b border-gray-200 px-6 pt-3 print-hidden">
                    <!-- Dùng Grid và class summary-row-grid để đảm bảo căn đều với dữ liệu bên dưới -->
                    <div
                        class="grid summary-row-grid text-xs text-gray-500 font-medium whitespace-nowrap overflow-x-auto custom-scroll">
                        <div class="pb-2 px-3"></div> <!-- Cột rỗng cho Checkbox -->
                        <div class="pb-2 px-3 border-b-2 border-red-600 text-red-600 cursor-pointer">Mã nhập hàng
                        </div>
                        <div class="pb-2 px-3 hover:text-gray-800 cursor-pointer">Thời gian</div>
                        <div class="pb-2 px-3 hover:text-gray-800 cursor-pointer">Mã NCC</div>
                        <div class="pb-2 px-3 hover:text-gray-800 cursor-pointer">Nhà cung cấp</div>
                        <div class="pb-2 px-3 hover:text-gray-800 cursor-pointer text-right">Cần trả NCC</div>
                        <div class="pb-2 px-3">Trạng thái</div> <!-- Cột rỗng cho trạng thái -->
                    </div>
                </div>

                <!-- Khung cuộn cho danh sách phiếu và chi tiết - Giảm padding -->
                <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-3 main-content-container">

                    <!-- Dòng phiếu nhập 1 (Mặc định Mở - Đã nhập hàng) -->
                    <div class="inventory-item item-open bg-white rounded-md shadow-xl" data-status="Đã nhập hàng">

                        <!-- Dòng tóm tắt phiếu, sử dụng Grid và text-sm/text-xs -->
                        <div id="summary-pn000001"
                            class="summary-row grid summary-row-grid items-center py-2 px-3 text-sm cursor-pointer transition duration-150 rounded-t-md"
                            onclick="toggleDetail('detail-pn000001')">
                            <!-- Checkbox -->
                            <div class="flex justify-center px-3">
                                <input type="checkbox" class="w-3.5 h-3.5 rounded text-red-600 focus:ring-red-500">
                            </div>
                            <!-- Mã nhập hàng -->
                            <div class="px-3 font-semibold text-gray-800 text-sm">PN000001</div>
                            <!-- Thời gian -->
                            <div class="px-3 text-gray-600 whitespace-nowrap text-xs">10/10/2025 10:20</div>
                            <!-- Mã NCC -->
                            <div class="px-3 text-gray-600 text-xs">NCC00001</div>
                            <!-- Nhà cung cấp -->
                            <div class="px-3 font-medium text-gray-800 truncate text-sm">NCC ĐỒNG NAI</div>
                            <!-- Cần trả NCC -->
                            <div class="px-3 text-gray-600 text-right text-sm amount-payable">3,500,000,000</div>
                            <!-- Trạng thái -->
                            <div class="flex justify-start px-3">
                                <span
                                    class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-800">Đã
                                    nhập hàng</span>
                            </div>
                        </div>

                        <!-- Chi tiết phiếu (Detail Panel) -->
                        <div id="detail-pn000001"
                            class="detail-panel border-t border-red-300 bg-white p-4 rounded-b-md">

                            <!-- Tab chi tiết (Đã xóa Lịch sử thanh toán) -->
                            <div class="flex space-x-4 border-b border-gray-200 mb-3 text-sm">
                                <div class="pb-1 text-red-600 border-b-2 border-red-600 font-semibold cursor-pointer">
                                    Thông tin</div>
                            </div>

                            <!-- Header chi tiết -->
                            <div class="flex justify-between items-start mb-4">
                                <h3 class="text-lg font-bold text-gray-800 flex items-center space-x-2">
                                    <span>PN000001</span>
                                    <span
                                        class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-800">Đã
                                        nhập hàng</span>
                                </h3>

                            </div>

                            <!-- Phần thông tin chung -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 text-xs">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Người tạo</label>
                                    <select class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <option>Kim Ngân</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Người nhập</label>
                                    <select class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <option>Kim Ngân</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Ngày nhập</label>
                                    <div class="relative">
                                        <input type="date" value="2025-10-10"
                                            class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <svg class="w-3.5 h-3.5 text-gray-400 absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"
                                            fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M8 7V3m8 4V3m-9 8h.01M3 21h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v12a2 2 0 002 2z">
                                            </path>
                                        </svg>
                                    </div>
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Nhà cung cấp</label>
                                    <div class="flex space-x-2">
                                        <div class="flex-1">
                                            <input type="text" value="NCC ĐỒNG NAI" readonly
                                                class="w-full p-1.5 border border-gray-300 rounded-md text-sm bg-gray-50">
                                            <p class="text-xs text-red-600 mt-1">Mã NCC: NCC00001</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bảng chi tiết hàng hóa -->
                            <div class="border border-gray-200 rounded-md overflow-hidden mb-4">
                                <table id="table-pn000001" class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th
                                                class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Mã hàng</th>
                                            <th
                                                class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Tên hàng</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Số lượng</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Đơn giá</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Giảm giá</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Giá nhập</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Thành tiền</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200 text-sm">
                                        <!-- Dòng tìm kiếm/thêm mới -->
                                        <tr class="print-hidden">
                                            <td class="p-1.5">
                                                <input type="text" placeholder="Tìm mã hàng"
                                                    class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                            </td>
                                            <td class="p-1.5">
                                                <input type="text" placeholder="Tìm tên hàng"
                                                    class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                            </td>
                                            <td colspan="5" class="p-1.5">
                                                <!-- Ô trống cho các cột còn lại -->
                                            </td>
                                        </tr>
                                        <!-- Dòng dữ liệu hàng hóa -->
                                        <tr class="text-xs">
                                            <td class="px-2 py-2.5 text-red-600 font-medium">SP000002</td>
                                            <td class="px-2 py-2.5 font-medium text-gray-800">VARIO</td>
                                            <td class="px-2 py-2.5 text-right">100</td>
                                            <td class="px-2 py-2.5 text-right">35,000,000</td>
                                            <td class="px-2 py-2.5 text-right">0</td>
                                            <td class="px-2 py-2.5 text-right">35,000,000</td>
                                            <td class="px-2 py-2.5 text-right font-semibold">3,500,000,000</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Tổng kết và Ghi chú -->
                            <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-6">
                                <!-- Ghi chú -->
                                <div class="flex-1">
                                    <textarea placeholder="Ghi chú..." rows="3"
                                        class="w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-red-500 focus:border-red-500 resize-none"></textarea>
                                </div>

                                <!-- Tổng kết phải -->
                                <div class="w-full md:w-64 space-y-1 text-xs">
                                    <div class="text-right print-hidden">
                                        <button class="text-red-600 font-medium text-xs hover:underline">Thiết lập
                                            giá</button>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Số lượng mặt hàng</span>
                                        <span class="font-medium text-gray-800">1</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Tổng tiền hàng (100)</span>
                                        <span class="font-medium text-gray-800">3,500,000,000</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Giảm giá</span>
                                        <span class="font-medium text-gray-800">0</span>
                                    </div>
                                    <div class="flex justify-between pt-1 border-t">
                                        <span class="text-gray-600 font-semibold">Tổng cộng</span>
                                        <span class="font-bold text-gray-900 text-sm">3,500,000,000</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Tiền đã trả NCC</span>
                                        <span class="font-bold text-red-600">3,500,000,000</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Thanh hành động chi tiết phiếu (ĐÃ CẬP NHẬT) -->
                            <div
                                class="flex justify-between items-center mt-4 pt-3 border-t border-gray-200 print-hidden">
                                <div class="flex items-center space-x-3">
                                    <button onclick="deleteItem(this)"
                                        class="flex items-center space-x-1.5 text-red-600 py-1.5 px-3 rounded-md hover:bg-red-50 text-xs font-medium transition duration-150">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                            </path>
                                        </svg>
                                        <span>Xoá phiếu</span>
                                    </button>
                                    <button onclick="exportToExcel('table-pn000001', 'PN000001')"
                                        class="flex items-center space-x-1.5 text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4">
                                            </path>
                                        </svg>
                                        <span>Xuất Excel</span>
                                    </button>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <a href="them-moi-phieu-nhap.html"><button
                                            class="bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-xs font-medium transition duration-150 flex items-center space-x-1.5">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                                                </path>
                                            </svg>
                                            <span>Mở phiếu</span>
                                        </button>
                                    </a>

                                    <button onclick="prepareAndPrint(this)"
                                        class="text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150 border border-gray-300 flex items-center space-x-1.5">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm7-8V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                                            </path>
                                        </svg>
                                        <span>In PDF</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Dòng phiếu nhập 2 (Mặc định ẨN - Phiếu tạm) -->
                    <div class="inventory-item bg-white rounded-md shadow-sm border border-gray-200"
                        data-status="Phiếu tạm">
                        <!-- Dòng tóm tắt phiếu 2, sử dụng Grid và text-sm/text-xs -->
                        <div id="summary-pn000002"
                            class="summary-row grid summary-row-grid items-center py-2 px-3 text-sm hover:bg-gray-50 cursor-pointer transition duration-150 rounded-md"
                            onclick="toggleDetail('detail-pn000002')">
                            <!-- Checkbox -->
                            <div class="flex justify-center px-3">
                                <input type="checkbox" class="w-3.5 h-3.5 rounded text-red-600 focus:ring-red-500">
                            </div>
                            <!-- Mã nhập hàng -->
                            <div class="px-3 font-semibold text-gray-800 text-sm">PN000002</div>
                            <!-- Thời gian -->
                            <div class="px-3 text-gray-600 whitespace-nowrap text-xs">10/10/2025 09:30</div>
                            <!-- Mã NCC -->
                            <div class="px-3 text-gray-600 text-xs">NCC00002</div>
                            <!-- Nhà cung cấp -->
                            <div class="px-3 font-medium text-gray-800 truncate text-sm">NCC PHÚ THỌ</div>
                            <!-- Cần trả NCC -->
                            <div class="px-3 text-gray-600 text-right text-sm amount-payable">3,440,700,000</div>
                            <!-- Trạng thái -->
                            <div class="flex justify-start px-3">
                                <span
                                    class="text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800">Phiếu
                                    tạm</span>
                            </div>
                        </div>

                        <!-- Chi tiết phiếu 2 (Detail Panel) - Mặc định ẨN -->
                        <div id="detail-pn000002"
                            class="detail-panel border-t border-gray-200 bg-white p-4 hidden rounded-b-md">

                            <!-- Tab chi tiết -->
                            <div class="flex space-x-4 border-b border-gray-200 mb-3 text-sm">
                                <div class="pb-1 text-red-600 border-b-2 border-red-600 font-semibold cursor-pointer">
                                    Thông tin</div>
                            </div>

                            <!-- Header chi tiết -->
                            <div class="flex justify-between items-start mb-4">
                                <h3 class="text-lg font-bold text-gray-800 flex items-center space-x-2">
                                    <span>PN000002</span>
                                    <span
                                        class="text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800">Phiếu
                                        tạm</span>
                                </h3>

                            </div>

                            <!-- Phần thông tin chung -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 text-xs">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Người tạo</label>
                                    <select class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <option>Trần Văn A</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Người nhập</label>
                                    <select class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <option>Lê Thị B</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Ngày nhập</label>
                                    <div class="relative">
                                        <input type="date" value="2025-10-10"
                                            class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <svg class="w-3.5 h-3.5 text-gray-400 absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"
                                            fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M8 7V3m8 4V3m-9 8h.01M3 21h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v12a2 2 0 002 2z">
                                            </path>
                                        </svg>
                                    </div>
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Nhà cung cấp</label>
                                    <div class="flex space-x-2">
                                        <div class="flex-1">
                                            <input type="text" value="NCC PHÚ THỌ" readonly
                                                class="w-full p-1.5 border border-gray-300 rounded-md text-sm bg-gray-50">
                                            <p class="text-xs text-red-600 mt-1">Mã NCC: NCC00002</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bảng chi tiết hàng hóa -->
                            <div class="border border-gray-200 rounded-md overflow-hidden mb-4">
                                <table id="table-pn000002" class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th
                                                class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Mã hàng</th>
                                            <th
                                                class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Tên hàng</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Số lượng</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Đơn giá</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Giảm giá</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Giá nhập</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Thành tiền</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200 text-sm">
                                        <!-- Dòng tìm kiếm/thêm mới -->
                                        <tr class="print-hidden">
                                            <td class="p-1.5"><input type="text" placeholder="Tìm mã hàng"
                                                    class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                            </td>
                                            <td class="p-1.5"><input type="text" placeholder="Tìm tên hàng"
                                                    class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                            </td>
                                            <td colspan="5" class="p-1.5"></td>
                                        </tr>
                                        <!-- Dữ liệu hàng hóa MẪU 1 -->
                                        <tr class="text-xs">
                                            <td class="px-2 py-2.5 text-red-600 font-medium">SP001001</td>
                                            <td class="px-2 py-2.5 font-medium text-gray-800">SH Mode 2024</td>
                                            <td class="px-2 py-2.5 text-right">30</td>
                                            <td class="px-2 py-2.5 text-right">65,000,000</td>
                                            <td class="px-2 py-2.5 text-right">300,000</td>
                                            <td class="px-2 py-2.5 text-right">64,700,000</td>
                                            <td class="px-2 py-2.5 text-right font-semibold">1,941,000,000</td>
                                        </tr>
                                        <!-- Dữ liệu hàng hóa MẪU 2 -->
                                        <tr class="text-xs bg-gray-50">
                                            <td class="px-2 py-2.5 text-red-600 font-medium">SP001002</td>
                                            <td class="px-2 py-2.5 font-medium text-gray-800">Vision 2023</td>
                                            <td class="px-2 py-2.5 text-right">50</td>
                                            <td class="px-2 py-2.5 text-right">30,000,000</td>
                                            <td class="px-2 py-2.5 text-right">0</td>
                                            <td class="px-2 py-2.5 text-right">30,000,000</td>
                                            <td class="px-2 py-2.5 text-right font-semibold">1,500,000,000</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Tổng kết và Ghi chú -->
                            <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-6">
                                <div class="flex-1">
                                    <textarea placeholder="Ghi chú..." rows="3"
                                        class="w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-red-500 focus:border-red-500 resize-none">Nhập hàng đầu tháng, số lượng lớn.</textarea>
                                </div>
                                <div class="w-full md:w-64 space-y-1 text-xs">
                                    <div class="text-right print-hidden"><button
                                            class="text-red-600 font-medium text-xs hover:underline">Thiết lập
                                            giá</button></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Số lượng mặt
                                            hàng</span><span class="font-medium text-gray-800">2</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Tổng tiền hàng
                                            (80)</span><span class="font-medium text-gray-800">3,441,000,000</span>
                                    </div>
                                    <div class="flex justify-between"><span class="text-gray-600">Giảm giá</span><span
                                            class="font-medium text-gray-800">300,000</span></div>
                                    <div class="flex justify-between pt-1 border-t"><span
                                            class="text-gray-600 font-semibold">Tổng cộng</span><span
                                            class="font-bold text-gray-900 text-sm">3,440,700,000</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Tiền đã trả
                                            NCC</span><span class="font-bold text-red-600">1,200,000,000</span></div>
                                </div>
                            </div>
                            <!-- Thanh hành động chi tiết phiếu (ĐÃ CẬP NHẬT) -->
                            <div
                                class="flex justify-between items-center mt-4 pt-3 border-t border-gray-200 print-hidden">
                                <div class="flex items-center space-x-3">
                                    <button onclick="deleteItem(this)"
                                        class="flex items-center space-x-1.5 text-red-600 py-1.5 px-3 rounded-md hover:bg-red-50 text-xs font-medium transition duration-150"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                            </path>
                                        </svg><span>Xoá phiếu</span></button>
                                    <button onclick="exportToExcel('table-pn000002', 'PN000002')"
                                        class="flex items-center space-x-1.5 text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4">
                                            </path>
                                        </svg><span>Xuất Excel</span></button>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <a href="them-moi-phieu-nhap.html"><button
                                            class="bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-xs font-medium transition duration-150 flex items-center space-x-1.5">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                                                </path>
                                            </svg>
                                            <span>Mở phiếu</span>
                                        </button>
                                    </a>

                                    <button onclick="prepareAndPrint(this)"
                                        class="text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150 border border-gray-300 flex items-center space-x-1.5"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm7-8V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                                            </path>
                                        </svg><span>In PDF</span></button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Dòng phiếu nhập 3 (Mặc định ẨN - Đã hủy) -->
                    <div class="inventory-item bg-white rounded-md shadow-sm border border-gray-200"
                        data-status="Đã hủy">
                        <div id="summary-pn000003"
                            class="summary-row grid summary-row-grid items-center py-2 px-3 text-sm hover:bg-gray-50 cursor-pointer transition duration-150 rounded-md"
                            onclick="toggleDetail('detail-pn000003')">
                            <div class="flex justify-center px-3">
                                <input type="checkbox" class="w-3.5 h-3.5 rounded text-red-600 focus:ring-red-500">
                            </div>
                            <div class="px-3 font-semibold text-gray-800 text-sm">PN000003</div>
                            <div class="px-3 text-gray-600 whitespace-nowrap text-xs">09/10/2025 15:00</div>
                            <div class="px-3 text-gray-600 text-xs">NCC00003</div>
                            <div class="px-3 font-medium text-gray-800 truncate text-sm">NCC QUẢNG NAM</div>
                            <div class="px-3 text-gray-600 text-right text-sm amount-payable">0</div>
                            <div class="flex justify-start px-3">
                                <span class="text-xs font-semibold px-2 py-0.5 rounded-full bg-red-100 text-red-800">Đã
                                    hủy</span>
                            </div>
                        </div>

                        <!-- Chi tiết phiếu 3 (Detail Panel) - Mặc định ẨN -->
                        <div id="detail-pn000003"
                            class="detail-panel border-t border-gray-200 bg-white p-4 hidden rounded-b-md">

                            <!-- Tab chi tiết -->
                            <div class="flex space-x-4 border-b border-gray-200 mb-3 text-sm">
                                <div class="pb-1 text-red-600 border-b-2 border-red-600 font-semibold cursor-pointer">
                                    Thông tin</div>
                            </div>

                            <!-- Header chi tiết -->
                            <div class="flex justify-between items-start mb-4">
                                <h3 class="text-lg font-bold text-gray-800 flex items-center space-x-2">
                                    <span>PN000003</span>
                                    <span
                                        class="text-xs font-semibold px-2 py-0.5 rounded-full bg-red-100 text-red-800">Đã
                                        hủy</span>
                                </h3>

                            </div>

                            <!-- Phần thông tin chung -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 text-xs">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Người tạo</label>
                                    <select class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <option>Nguyễn Văn C</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Người nhập</label>
                                    <select class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <option>Đã hủy</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Ngày nhập</label>
                                    <div class="relative">
                                        <input type="date" value="2025-10-09"
                                            class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <svg class="w-3.5 h-3.5 text-gray-400 absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"
                                            fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M8 7V3m8 4V3m-9 8h.01M3 21h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v12a2 2 0 002 2z">
                                            </path>
                                        </svg>
                                    </div>
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Nhà cung cấp</label>
                                    <div class="flex space-x-2">
                                        <div class="flex-1">
                                            <input type="text" value="NCC QUẢNG NAM" readonly
                                                class="w-full p-1.5 border border-gray-300 rounded-md text-sm bg-gray-50">
                                            <p class="text-xs text-red-600 mt-1">Mã NCC: NCC00003</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bảng chi tiết hàng hóa -->
                            <div class="border border-gray-200 rounded-md overflow-hidden mb-4">
                                <table id="table-pn000003" class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th
                                                class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Mã hàng</th>
                                            <th
                                                class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Tên hàng</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Số lượng</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Đơn giá</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Giảm giá</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Giá nhập</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Thành tiền</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200 text-sm">
                                        <tr class="print-hidden">
                                            <td colspan="7"
                                                class="p-1.5 bg-gray-100 text-center text-xs text-gray-500 italic">Phiếu
                                                nhập đã bị hủy. Không thể chỉnh sửa chi tiết hàng hóa.</td>
                                        </tr>
                                        <tr class="text-xs">
                                            <td class="px-2 py-2.5 text-red-600 font-medium">SP002001</td>
                                            <td class="px-2 py-2.5 font-medium text-gray-800">Sirius 2024</td>
                                            <td class="px-2 py-2.5 text-right">40</td>
                                            <td class="px-2 py-2.5 text-right">12,500,000</td>
                                            <td class="px-2 py-2.5 text-right">0</td>
                                            <td class="px-2 py-2.5 text-right">12,500,000</td>
                                            <td class="px-2 py-2.5 text-right font-semibold">500,000,000</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Tổng kết và Ghi chú -->
                            <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-6">
                                <div class="flex-1">
                                    <textarea placeholder="Ghi chú..." rows="3"
                                        class="w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-red-500 focus:border-red-500 resize-none"
                                        readonly>Đã hủy do lỗi đặt hàng sai mẫu mã.</textarea>
                                </div>
                                <div class="w-full md:w-64 space-y-1 text-xs">
                                    <div class="text-right print-hidden"><button
                                            class="text-red-600 font-medium text-xs hover:underline" disabled>Thiết lập
                                            giá</button></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Số lượng mặt
                                            hàng</span><span class="font-medium text-gray-800">1</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Tổng tiền hàng
                                            (40)</span><span class="font-medium text-gray-800">500,000,000</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Giảm giá</span><span
                                            class="font-medium text-gray-800">0</span></div>
                                    <div class="flex justify-between pt-1 border-t"><span
                                            class="text-gray-600 font-semibold">Tổng cộng</span><span
                                            class="font-bold text-gray-900 text-sm">500,000,000</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Tiền đã trả
                                            NCC</span><span class="font-bold text-red-600">0</span></div>
                                </div>
                            </div>

                            <!-- Thanh hành động chi tiết phiếu (ĐÃ CẬP NHẬT) -->
                            <div
                                class="flex justify-between items-center mt-4 pt-3 border-t border-gray-200 print-hidden">
                                <div class="flex items-center space-x-3">
                                    <button onclick="deleteItem(this)"
                                        class="flex items-center space-x-1.5 text-red-600 py-1.5 px-3 rounded-md hover:bg-red-50 text-xs font-medium transition duration-150"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                            </path>
                                        </svg><span>Xoá phiếu</span></button>
                                    <button onclick="exportToExcel('table-pn000003', 'PN000003')"
                                        class="flex items-center space-x-1.5 text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4">
                                            </path>
                                        </svg><span>Xuất Excel</span></button>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <a href="them-moi-phieu-nhap.html"><button
                                            class="bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-xs font-medium transition duration-150 flex items-center space-x-1.5">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                                                </path>
                                            </svg>
                                            <span>Mở phiếu</span>
                                        </button>
                                    </a>

                                    <button onclick="prepareAndPrint(this)"
                                        class="text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150 border border-gray-300 flex items-center space-x-1.5"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm7-8V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                                            </path>
                                        </svg><span>In PDF</span></button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Dòng phiếu nhập 4 (Mặc định ẨN - Đã nhập hàng) -->
                    <div class="inventory-item bg-white rounded-md shadow-sm border border-gray-200"
                        data-status="Đã nhập hàng">
                        <div id="summary-pn000004"
                            class="summary-row grid summary-row-grid items-center py-2 px-3 text-sm hover:bg-gray-50 cursor-pointer transition duration-150 rounded-md"
                            onclick="toggleDetail('detail-pn000004')">
                            <div class="flex justify-center px-3"><input type="checkbox"
                                    class="w-3.5 h-3.5 rounded text-red-600 focus:ring-red-500"></div>
                            <div class="px-3 font-semibold text-gray-800 text-sm">PN000004</div>
                            <div class="px-3 text-gray-600 whitespace-nowrap text-xs">08/10/2025 11:45</div>
                            <div class="px-3 text-gray-600 text-xs">NCC00004</div>
                            <div class="px-3 font-medium text-gray-800 truncate text-sm">NCC MIỀN TÂY</div>
                            <div class="px-3 text-gray-600 text-right text-sm amount-payable">6,000,000,000</div>
                            <div class="flex justify-start px-3"><span
                                    class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-800">Đã
                                    nhập hàng</span></div>
                        </div>

                        <!-- Chi tiết phiếu 4 (Detail Panel) - Mặc định ẨN -->
                        <div id="detail-pn000004"
                            class="detail-panel border-t border-gray-200 bg-white p-4 hidden rounded-b-md">
                            <div class="flex space-x-4 border-b border-gray-200 mb-3 text-sm">
                                <div class="pb-1 text-red-600 border-b-2 border-red-600 font-semibold cursor-pointer">
                                    Thông tin</div>
                            </div>
                            <div class="flex justify-between items-start mb-4">
                                <h3 class="text-lg font-bold text-gray-800 flex items-center space-x-2">
                                    <span>PN000004</span>
                                    <span
                                        class="text-xs font-semibold px-2 py-0.5 rounded-full bg-green-100 text-green-800">Đã
                                        nhập hàng</span>
                                </h3>
                            </div>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 text-xs">
                                <div><label class="block text-xs font-medium text-gray-500 mb-1">Người
                                        tạo</label><select
                                        class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <option>Phạm Văn D</option>
                                    </select></div>
                                <div><label class="block text-xs font-medium text-gray-500 mb-1">Người
                                        nhập</label><select
                                        class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                        <option>Phạm Văn D</option>
                                    </select></div>
                                <div><label class="block text-xs font-medium text-gray-500 mb-1">Ngày nhập</label>
                                    <div class="relative"><input type="date" value="2025-10-08"
                                            class="w-full p-1.5 border border-gray-300 rounded-md text-sm"><svg
                                            class="w-3.5 h-3.5 text-gray-400 absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"
                                            fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M8 7V3m8 4V3m-9 8h.01M3 21h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v12a2 2 0 002 2z">
                                            </path>
                                        </svg></div>
                                </div>
                                <div class="col-span-2"><label class="block text-xs font-medium text-gray-500 mb-1">Nhà
                                        cung cấp</label>
                                    <div class="flex space-x-2">
                                        <div class="flex-1"><input type="text" value="NCC MIỀN TÂY" readonly
                                                class="w-full p-1.5 border border-gray-300 rounded-md text-sm bg-gray-50">
                                            <p class="text-xs text-red-600 mt-1">Mã NCC: NCC00004</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="border border-gray-200 rounded-md overflow-hidden mb-4">
                                <table id="table-pn000004" class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th
                                                class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Mã hàng</th>
                                            <th
                                                class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Tên hàng</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Số lượng</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Đơn giá</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Giảm giá</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Giá nhập</th>
                                            <th
                                                class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                Thành tiền</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200 text-sm">
                                        <tr class="print-hidden">
                                            <td class="p-1.5"><input type="text" placeholder="Tìm mã hàng"
                                                    class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                            </td>
                                            <td class="p-1.5"><input type="text" placeholder="Tìm tên hàng"
                                                    class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                            </td>
                                            <td colspan="5" class="p-1.5"></td>
                                        </tr>
                                        <tr class="text-xs">
                                            <td class="px-2 py-2.5 text-red-600 font-medium">SP003001</td>
                                            <td class="px-2 py-2.5 font-medium text-gray-800">Exciter 155</td>
                                            <td class="px-2 py-2.5 text-right">50</td>
                                            <td class="px-2 py-2.5 text-right">40,000,000</td>
                                            <td class="px-2 py-2.5 text-right">0</td>
                                            <td class="px-2 py-2.5 text-right">40,000,000</td>
                                            <td class="px-2 py-2.5 text-right font-semibold">2,000,000,000</td>
                                        </tr>
                                        <tr class="text-xs bg-gray-50">
                                            <td class="px-2 py-2.5 text-red-600 font-medium">SP003002</td>
                                            <td class="px-2 py-2.5 font-medium text-gray-800">Winner X</td>
                                            <td class="px-2 py-2.5 text-right">100</td>
                                            <td class="px-2 py-2.5 text-right">40,000,000</td>
                                            <td class="px-2 py-2.5 text-right">0</td>
                                            <td class="px-2 py-2.5 text-right">40,000,000</td>
                                            <td class="px-2 py-2.5 text-right font-semibold">4,000,000,000</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-6">
                                <div class="flex-1"><textarea placeholder="Ghi chú..." rows="3"
                                        class="w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-red-500 focus:border-red-500 resize-none"></textarea>
                                </div>
                                <div class="w-full md:w-64 space-y-1 text-xs">
                                    <div class="text-right print-hidden"><button
                                            class="text-red-600 font-medium text-xs hover:underline">Thiết lập
                                            giá</button></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Số lượng mặt
                                            hàng</span><span class="font-medium text-gray-800">2</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Tổng tiền hàng
                                            (150)</span><span class="font-medium text-gray-800">6,000,000,000</span>
                                    </div>
                                    <div class="flex justify-between"><span class="text-gray-600">Giảm giá</span><span
                                            class="font-medium text-gray-800">0</span></div>
                                    <div class="flex justify-between pt-1 border-t"><span
                                            class="text-gray-600 font-semibold">Tổng cộng</span><span
                                            class="font-bold text-gray-900 text-sm">6,000,000,000</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600">Tiền đã trả
                                            NCC</span><span class="font-bold text-red-600">6,000,000,000</span></div>
                                </div>
                            </div>
                            <div
                                class="flex justify-between items-center mt-4 pt-3 border-t border-gray-200 print-hidden">
                                <div class="flex items-center space-x-3">
                                    <button onclick="deleteItem(this)"
                                        class="flex items-center space-x-1.5 text-red-600 py-1.5 px-3 rounded-md hover:bg-red-50 text-xs font-medium transition duration-150"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                            </path>
                                        </svg><span>Xoá phiếu</span></button>
                                    <button onclick="exportToExcel('table-pn000004', 'PN000004')"
                                        class="flex items-center space-x-1.5 text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4">
                                            </path>
                                        </svg><span>Xuất Excel</span></button>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <a href="them-moi-phieu-nhap.html"><button
                                            class="bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-xs font-medium transition duration-150 flex items-center space-x-1.5">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                                                </path>
                                            </svg>
                                            <span>Mở phiếu</span>
                                        </button>
                                    </a>

                                    <button onclick="prepareAndPrint(this)"
                                        class="text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150 border border-gray-300 flex items-center space-x-1.5"><svg
                                            class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm7-8V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                                            </path>
                                        </svg><span>In PDF</span></button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Dòng phiếu nhập 5 (Mặc định ẨN - Phiếu tạm) -->
                    <div class="inventory-item bg-white rounded-md shadow-sm border border-gray-200"
                        data-status="Phiếu tạm">
                        <div id="summary-pn000005"
                            class="summary-row grid summary-row-grid items-center py-2 px-3 text-sm hover:bg-gray-50 cursor-pointer transition duration-150 rounded-md"
                            onclick="toggleDetail('detail-pn000005')">
                            <div class="flex justify-center px-3"><input type="checkbox"
                                    class="w-3.5 h-3.5 rounded text-red-600 focus:ring-red-500"></div>
                            <div class="px-3 font-semibold text-gray-800 text-sm">PN000005</div>
                            <div class="px-3 text-gray-600 whitespace-nowrap text-xs">07/10/2025 16:10</div>
                            <div class="px-3 text-gray-600 text-xs">NCC00005</div>
                            <div class="px-3 font-medium text-gray-800 truncate text-sm">NCC HÀ NỘI</div>
                            <div class="px-3 text-gray-600 text-right text-sm amount-payable">600,000,000</div>
                            <div class="flex justify-start px-3"><span
                                    class="text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800">Phiếu
                                    tạm</span></div>
                        </div>

                        <!-- Chi tiết phiếu 5 (Detail Panel) - Mặc định ẨN -->
                        <div id="detail-pn000005"
                            class="detail-panel border-t border-gray-200 bg-white p-4 hidden rounded-b-md">
                            <div class="flex space-x-4 border-b border-gray-200 mb-3 text-sm">
                                <div class="pb-1 text-red-600 border-b-2 border-red-600 font-semibold cursor-pointer">
                                    Thông tin</div>
                            </div>
                            <div class="flex justify-between items-start mb-4">
                                <h3 class="text-lg font-bold text-gray-800 flex items-center space-x-2">
                                    <span>PN000005</span>
                                    <span
                                        class="text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800">Phiếu
                                        tạm</span>
                                </h3>
                                <<<<<<< HEAD </div>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 text-xs">
                                        <div><label class="block text-xs font-medium text-gray-500 mb-1">Người
                                                tạo</label><select
                                                class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                                <option>Lê Văn E</option>
                                            </select></div>
                                        <div><label class="block text-xs font-medium text-gray-500 mb-1">Người
                                                nhập</label><select
                                                class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                                <option>Trần Thị F</option>
                                            </select></div>
                                        <div><label class="block text-xs font-medium text-gray-500 mb-1">Ngày
                                                nhập</label>
                                            <div class="relative"><input type="date" value="2025-10-07"
                                                    class="w-full p-1.5 border border-gray-300 rounded-md text-sm"><svg
                                                    class="w-3.5 h-3.5 text-gray-400 absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"
                                                    fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M8 7V3m8 4V3m-9 8h.01M3 21h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v12a2 2 0 002 2z">
                                                    </path>
                                                </svg></div>
                                        </div>
                                        <div class="col-span-2"><label
                                                class="block text-xs font-medium text-gray-500 mb-1">Nhà
                                                cung cấp</label>
                                            <div class="flex space-x-2">
                                                <div class="flex-1"><input type="text" value="NCC HÀ NỘI" readonly
                                                        class="w-full p-1.5 border border-gray-300 rounded-md text-sm bg-gray-50">
                                                    <p class="text-xs text-red-600 mt-1">Mã NCC: NCC00005</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="border border-gray-200 rounded-md overflow-hidden mb-4">
                                        <table id="table-pn000005" class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th
                                                        class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Mã hàng</th>
                                                    <th
                                                        class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Tên hàng</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Số lượng</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Đơn giá</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Giảm giá</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Giá nhập</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Thành tiền</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200 text-sm">
                                                <tr class="print-hidden">
                                                    <td class="p-1.5"><input type="text" placeholder="Tìm mã hàng"
                                                            class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                                    </td>
                                                    <td class="p-1.5"><input type="text" placeholder="Tìm tên hàng"
                                                            class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                                    </td>
                                                    <td colspan="5" class="p-1.5"></td>
                                                </tr>
                                                <tr class="text-xs">
                                                    <td class="px-2 py-2.5 text-red-600 font-medium">SP004001</td>
                                                    <td class="px-2 py-2.5 font-medium text-gray-800">Air Blade 2023
                                                    </td>
                                                    <td class="px-2 py-2.5 text-right">20</td>
                                                    <td class="px-2 py-2.5 text-right">40,000,000</td>
                                                    <td class="px-2 py-2.5 text-right">0</td>
                                                    <td class="px-2 py-2.5 text-right">40,000,000</td>
                                                    <td class="px-2 py-2.5 text-right font-semibold">800,000,000</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-6">
                                        <div class="flex-1"><textarea placeholder="Ghi chú..." rows="3"
                                                class="w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-red-500 focus:border-red-500 resize-none">Đang chờ xác nhận từ kho trước khi thanh toán nốt.</textarea>
                                        </div>
                                        <div class="w-full md:w-64 space-y-1 text-xs">
                                            <div class="text-right print-hidden"><button
                                                    class="text-red-600 font-medium text-xs hover:underline">Thiết lập
                                                    giá</button></div>
                                            <div class="flex justify-between"><span class="text-gray-600">Số lượng mặt
                                                    hàng</span><span class="font-medium text-gray-800">1</span></div>
                                            <div class="flex justify-between"><span class="text-gray-600">Tổng tiền hàng
                                                    (20)</span><span
                                                    class="font-medium text-gray-800">800,000,000</span></div>
                                            <div class="flex justify-between"><span class="text-gray-600">Giảm
                                                    giá</span><span class="font-medium text-gray-800">0</span></div>
                                            <div class="flex justify-between pt-1 border-t"><span
                                                    class="text-gray-600 font-semibold">Tổng cộng</span><span
                                                    class="font-bold text-gray-900 text-sm">800,000,000</span></div>
                                            <div class="flex justify-between"><span class="text-gray-600">Tiền đã trả
                                                    NCC</span><span class="font-bold text-red-600">200,000,000</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="flex justify-between items-center mt-4 pt-3 border-t border-gray-200 print-hidden">
                                        <div class="flex items-center space-x-3">
                                            <button onclick="deleteItem(this)"
                                                class="flex items-center space-x-1.5 text-red-600 py-1.5 px-3 rounded-md hover:bg-red-50 text-xs font-medium transition duration-150"><svg
                                                    class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                                    </path>
                                                </svg><span>Xoá phiếu</span></button>
                                            <button onclick="exportToExcel('table-pn000005', 'PN000005')"
                                                class="flex items-center space-x-1.5 text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150"><svg
                                                    class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4">
                                                    </path>
                                                </svg><span>Xuất Excel</span></button>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <a href="them-moi-phieu-nhap.html"><button
                                                    class="bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-xs font-medium transition duration-150 flex items-center space-x-1.5">
                                                    <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                                        viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                                                        </path>
                                                    </svg>
                                                    <span>Mở phiếu</span>
                                                </button>
                                            </a>

                                            <button onclick="prepareAndPrint(this)"
                                                class="text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150 border border-gray-300 flex items-center space-x-1.5"><svg
                                                    class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm7-8V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                                                    </path>
                                                </svg><span>In PDF</span></button>
                                        </div>

                                    </div>
                                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 text-xs">
                                        <div><label class="block text-xs font-medium text-gray-500 mb-1">Người
                                                tạo</label><select
                                                class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                                <option>Lê Văn E</option>
                                            </select></div>
                                        <div><label class="block text-xs font-medium text-gray-500 mb-1">Người
                                                nhập</label><select
                                                class="w-full p-1.5 border border-gray-300 rounded-md text-sm">
                                                <option>Trần Thị F</option>
                                            </select></div>
                                        <div><label class="block text-xs font-medium text-gray-500 mb-1">Ngày
                                                nhập</label>
                                            <div class="relative"><input type="date" value="2025-10-07"
                                                    class="w-full p-1.5 border border-gray-300 rounded-md text-sm"><svg
                                                    class="w-3.5 h-3.5 text-gray-400 absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none"
                                                    fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M8 7V3m8 4V3m-9 8h.01M3 21h18a2 2 0 002-2V7a2 2 0 00-2-2H3a2 2 0 00-2 2v12a2 2 0 002 2z">
                                                    </path>
                                                </svg></div>
                                        </div>
                                        <div class="col-span-2"><label
                                                class="block text-xs font-medium text-gray-500 mb-1">Nhà
                                                cung cấp</label>
                                            <div class="flex space-x-2">
                                                <div class="flex-1"><input type="text" value="NCC HÀ NỘI" readonly
                                                        class="w-full p-1.5 border border-gray-300 rounded-md text-sm bg-gray-50">
                                                    <p class="text-xs text-red-600 mt-1">Mã NCC: NCC00005</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="border border-gray-200 rounded-md overflow-hidden mb-4">
                                        <table id="table-pn000005" class="min-w-full divide-y divide-gray-200">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th
                                                        class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Mã hàng</th>
                                                    <th
                                                        class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Tên hàng</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Số lượng</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Đơn giá</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Giảm giá</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Giá nhập</th>
                                                    <th
                                                        class="px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                        Thành tiền</th>
                                                </tr>
                                            </thead>
                                            <tbody class="bg-white divide-y divide-gray-200 text-sm">
                                                <tr class="print-hidden">
                                                    <td class="p-1.5"><input type="text" placeholder="Tìm mã hàng"
                                                            class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                                    </td>
                                                    <td class="p-1.5"><input type="text" placeholder="Tìm tên hàng"
                                                            class="w-full p-1 border border-gray-300 rounded text-xs focus:ring-red-500 focus:border-red-500">
                                                    </td>
                                                    <td colspan="5" class="p-1.5"></td>
                                                </tr>
                                                <tr class="text-xs">
                                                    <td class="px-2 py-2.5 text-red-600 font-medium">SP004001</td>
                                                    <td class="px-2 py-2.5 font-medium text-gray-800">Air Blade 2023
                                                    </td>
                                                    <td class="px-2 py-2.5 text-right">20</td>
                                                    <td class="px-2 py-2.5 text-right">40,000,000</td>
                                                    <td class="px-2 py-2.5 text-right">0</td>
                                                    <td class="px-2 py-2.5 text-right">40,000,000</td>
                                                    <td class="px-2 py-2.5 text-right font-semibold">800,000,000</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-6">
                                        <div class="flex-1"><textarea placeholder="Ghi chú..." rows="3"
                                                class="w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-red-500 focus:border-red-500 resize-none">Đang chờ xác nhận từ kho trước khi thanh toán nốt.</textarea>
                                        </div>
                                        <div class="w-full md:w-64 space-y-1 text-xs">
                                            <div class="text-right print-hidden"><button
                                                    class="text-red-600 font-medium text-xs hover:underline">Thiết lập
                                                    giá</button></div>
                                            <div class="flex justify-between"><span class="text-gray-600">Số lượng mặt
                                                    hàng</span><span class="font-medium text-gray-800">1</span></div>
                                            <div class="flex justify-between"><span class="text-gray-600">Tổng tiền hàng
                                                    (20)</span><span
                                                    class="font-medium text-gray-800">800,000,000</span></div>
                                            <div class="flex justify-between"><span class="text-gray-600">Giảm
                                                    giá</span><span class="font-medium text-gray-800">0</span></div>
                                            <div class="flex justify-between pt-1 border-t"><span
                                                    class="text-gray-600 font-semibold">Tổng cộng</span><span
                                                    class="font-bold text-gray-900 text-sm">800,000,000</span></div>
                                            <div class="flex justify-between"><span class="text-gray-600">Tiền đã trả
                                                    NCC</span><span class="font-bold text-red-600">200,000,000</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div
                                        class="flex justify-between items-center mt-4 pt-3 border-t border-gray-200 print-hidden">
                                        <div class="flex items-center space-x-3">
                                            <button onclick="deleteItem(this)"
                                                class="flex items-center space-x-1.5 text-red-600 py-1.5 px-3 rounded-md hover:bg-red-50 text-xs font-medium transition duration-150"><svg
                                                    class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                                    </path>
                                                </svg><span>Xoá phiếu</span></button>
                                            <button onclick="exportToExcel('table-pn000005', 'PN000005')"
                                                class="flex items-center space-x-1.5 text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150"><svg
                                                    class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4">
                                                    </path>
                                                </svg><span>Xuất Excel</span></button>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <a href="them-moi-phieu-nhap.html"><button
                                                    class="bg-red-600 text-white py-1.5 px-3 rounded-md hover:bg-red-700 text-xs font-medium transition duration-150 flex items-center space-x-1.5">
                                                    <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                                        viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14">
                                                        </path>
                                                    </svg>
                                                    <span>Mở phiếu</span>
                                                </button>
                                            </a>

                                            <button onclick="prepareAndPrint(this)"
                                                class="text-gray-600 py-1.5 px-3 rounded-md hover:bg-gray-100 text-xs font-medium transition duration-150 border border-gray-300 flex items-center space-x-1.5"><svg
                                                    class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm7-8V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                                                    </path>
                                                </svg><span>In PDF</span></button>
                                        </div>
                                    </div>
                            </div>
                        </div>

                    </div>

                    <!-- Footer hành động chính của trang -->
                    <footer
                        class="flex-shrink-0 bg-white border-t border-gray-200 py-2 px-4 flex justify-between items-center shadow-inner print-hidden">
                        <div class="flex items-center space-x-2 text-sm">
                            <span class="font-medium text-gray-600">Tổng cần trả NCC:</span>
                            <span id="total-payable" class="font-bold text-red-600 text-base">0</span>
                        </div>
                        <div class="text-xs text-gray-500">
                            Chọn một phiếu nhập để thực hiện các thao tác
                        </div>
                    </footer>

                </div>
            </div>
        </div>

        <!-- JavaScript để xử lý các chức năng -->
        <script>
            /**
             * Chuyển đổi trạng thái hiển thị của panel chi tiết.
             * @param {string} detailId ID của phần chi tiết cần ẩn/hiện.
             */
            function toggleDetail(detailId) {
                const detailPanel = document.getElementById(detailId);
                const inventoryItem = detailPanel.closest('.inventory-item');

                if (detailPanel.classList.contains('hidden')) {
                    // Hiển thị panel chi tiết
                    detailPanel.classList.remove('hidden');
                    inventoryItem.classList.add('item-open');
                    inventoryItem.classList.add('shadow-xl'); // Thêm shadow nổi bật hơn khi mở
                    inventoryItem.classList.remove('shadow-sm', 'border', 'border-gray-200'); // Xóa border cũ
                } else {
                    // Ẩn panel chi tiết
                    detailPanel.classList.add('hidden');
                    inventoryItem.classList.remove('item-open');
                    inventoryItem.classList.remove('shadow-xl');
                    inventoryItem.classList.add('shadow-sm', 'border', 'border-gray-200'); // Thêm lại border và shadow nhỏ
                }
            }

            /**
             * Xóa một phiếu nhập hàng.
             * @param {HTMLElement} button Nút "Xoá phiếu" được nhấn.
             */
            function deleteItem(button) {
                // Sử dụng một hộp thoại xác nhận đơn giản của trình duyệt
                // Lưu ý: trong một ứng dụng thực tế, bạn nên dùng một modal tùy chỉnh đẹp hơn.
                if (confirm('Bạn có chắc chắn muốn xoá phiếu nhập này không?')) {
                    const item = button.closest('.inventory-item');
                    if (item) {
                        item.remove();
                        // Cập nhật lại tổng tiền sau khi xóa
                        updateTotalPayable();
                    }
                }
            }

            /**
             * Chuẩn bị và thực hiện in chi tiết phiếu.
             * @param {HTMLElement} button Nút "In PDF" được nhấn.
             */
            function prepareAndPrint(button) {
                const itemToPrint = button.closest('.inventory-item');
                if (!itemToPrint) return;

                // Mở chi tiết phiếu nếu nó đang đóng
                const detailPanel = itemToPrint.querySelector('.detail-panel');
                const wasHidden = detailPanel.classList.contains('hidden');
                if (wasHidden) {
                    detailPanel.classList.remove('hidden');
                }

                // Thêm class để CSS biết mục nào cần in
                itemToPrint.classList.add('printing-item');

                // Gọi hàm in của trình duyệt
                window.print();

                // Dọn dẹp sau khi hộp thoại in đóng lại
                // Dùng setTimeout để đảm bảo việc dọn dẹp diễn ra sau khi lệnh in hoàn tất
                setTimeout(() => {
                    if (wasHidden) {
                        detailPanel.classList.add('hidden');
                    }
                    itemToPrint.classList.remove('printing-item');
                }, 500);
            }

            /**
             * Xuất dữ liệu từ bảng HTML ra file Excel.
             * @param {string} tableId ID của bảng cần xuất dữ liệu.
             * @param {string} fileName Tên file Excel sẽ được tạo (không bao gồm đuôi file).
             */
            function exportToExcel(tableId, fileName) {
                const table = document.getElementById(tableId);
                // Loại bỏ hàng tìm kiếm khỏi dữ liệu xuất
                const tableClone = table.cloneNode(true);
                const searchRow = tableClone.querySelector('tbody > tr:first-child.print-hidden');
                if (searchRow) {
                    searchRow.remove();
                }

                const wb = XLSX.utils.table_to_book(tableClone, { sheet: "Sheet JS" });
                XLSX.writeFile(wb, `${fileName}.xlsx`);
            }
        </script>

        <!-- SCRIPT LỌC TRẠNG THÁI, TÍNH TỔNG TIỀN, BỘ LỌC THỜI GIAN -->
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const statusFilters = document.querySelectorAll('.status-filter');
                const inventoryItems = document.querySelectorAll('.inventory-item');
                const totalPayableEl = document.getElementById('total-payable');

                /**
                 * Tính toán và cập nhật tổng số tiền cần trả cho NCC.
                 * Hàm này được gọi là 'updateTotalPayable' để dùng lại ở chức năng xóa.
                 */
                window.updateTotalPayable = function () {
                    let total = 0;
                    // Chỉ tính tổng các phiếu đang hiển thị
                    const visibleItems = document.querySelectorAll('.inventory-item:not([style*="display: none"])');

                    visibleItems.forEach(item => {
                        const amountEl = item.querySelector('.amount-payable');
                        if (amountEl) {
                            // Chuyển đổi chuỗi tiền tệ (vd: "3,500,000,000") thành số
                            const amount = parseFloat(amountEl.textContent.replace(/,/g, ''));
                            total += amount;
                        }
                    });

                    // Định dạng lại tổng tiền theo kiểu Việt Nam và hiển thị
                    totalPayableEl.textContent = total.toLocaleString('vi-VN');
                }

                /**
                 * Hàm áp dụng bộ lọc trạng thái.
                 */
                function applyStatusFilter() {
                    const visibleStatuses = new Set();
                    if (document.getElementById('status-draft').checked) visibleStatuses.add('Phiếu tạm');
                    if (document.getElementById('status-received').checked) visibleStatuses.add('Đã nhập hàng');
                    if (document.getElementById('status-cancelled').checked) visibleStatuses.add('Đã hủy');

                    inventoryItems.forEach(item => {
                        const itemStatus = item.dataset.status;
                        if (visibleStatuses.has(itemStatus)) {
                            item.style.display = '';
                        } else {
                            item.style.display = 'none';
                        }
                    });

                    // Sau khi lọc, tính lại tổng tiền
                    updateTotalPayable();
                }

                statusFilters.forEach(filter => {
                    filter.addEventListener('change', applyStatusFilter);
                });

                // --- XỬ LÝ BỘ LỌC THỜI GIAN ---
                const timeFilterButton = document.getElementById('time-filter-button');
                const timeFilterPopup = document.getElementById('time-filter-popup');
                const selectedTimeFilter = document.getElementById('selected-time-filter');
                const timeOptions = document.querySelectorAll('.time-option');

                // Mở/đóng popup và định vị lại
                timeFilterButton.addEventListener('click', (event) => {
                    event.stopPropagation();
                    const isHidden = timeFilterPopup.style.display === 'none' || timeFilterPopup.style.display === '';

                    if (isHidden) {
                        const rect = timeFilterButton.getBoundingClientRect();
                        timeFilterPopup.style.top = `${rect.top}px`;
                        timeFilterPopup.style.left = `${rect.right + 8}px`; // Thêm khoảng cách 8px
                        timeFilterPopup.style.display = 'block';
                    } else {
                        timeFilterPopup.style.display = 'none';
                    }
                });

                // Xử lý khi click vào một tùy chọn thời gian
                timeOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        selectedTimeFilter.textContent = option.textContent;
                        timeOptions.forEach(opt => opt.classList.remove('bg-red-600', 'text-white'));
                        option.classList.add('bg-red-600', 'text-white');
                        timeFilterPopup.style.display = 'none';
                    });
                });

                // Khởi tạo Flatpickr cho tùy chỉnh ngày
                flatpickr("#custom-date-range", {
                    mode: "range",
                    dateFormat: "d/m/Y",
                    locale: "vn",
                    onChange: function (selectedDates, dateStr, instance) {
                        if (selectedDates.length === 2) {
                            selectedTimeFilter.textContent = dateStr;
                            timeFilterPopup.style.display = 'none';
                        }
                    }
                });

                // Đóng popup khi click ra ngoài
                document.addEventListener('click', function (event) {
                    if (!timeFilterButton.contains(event.target) && !timeFilterPopup.contains(event.target)) {
                        timeFilterPopup.style.display = 'none';
                    }
                });

                // Gọi hàm tính tổng lần đầu khi tải trang
                updateTotalPayable();
            });
        </script>
</body>

</html>